# Production Docker Compose with Nginx
# Usage: docker compose -f docker-compose.yml -f docker-compose.prod.yml up -d

services:
  nginx:
    ports:
      - "80:80"
      - "443:443"
    volumes:
      - ./nginx.conf:/etc/nginx/conf.d/default.conf:ro
      - ./ssl:/etc/nginx/ssl:ro
    environment:
      - NGINX_ENVSUBST_OUTPUT_DIR=/etc/nginx

  api:
    environment:
      NODE_ENV: production
    # Remove volume mounts in production
    volumes: []

  web:
    environment:
      NODE_ENV: production
      NEXT_PUBLIC_API_URL: ${NEXT_PUBLIC_API_URL:-https://api.cite.app}
    # Remove volume mounts in production
    volumes: []
